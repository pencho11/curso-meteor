{"version":3,"sources":["meteor://ðŸ’»app/packages/blaze-hot/hot.js","meteor://ðŸ’»app/packages/blaze-hot/update-templates.js"],"names":["_typeof","module1","link","default","v","Blaze","Templates","Template","UpdateAll","importedTemplating","WeakMap","currentModule","id","SourceModule","Symbol","patchTemplate","oldRegisterHelper","registerHelper","name","func","oldOnCreated","prototype","onCreated","cb","call","oldOnRendered","onRendered","oldOnDestroyed","onDestroyed","oldHelpers","helpers","dict","k","oldEvents","events","eventMap","result","__eventMaps","length","cleanTemplate","template","moduleId","usedModule","isTemplate","cleanArray","array","i","item","splice","_callbacks","created","rendered","destroyed","Object","keys","__helpers","forEach","key","shouldAccept","module","get","exports","filter","hot","onRequire","before","set","previousModule","after","accept","dispose","templateName","usedByModule","_applyHmrChanges","values","_globalHelpers","helper","export","renderedTemplates","overrideTemplateContentBlock","overrideTemplateElseBlock","oldConstructView","constructView","view","apply","arguments","viewName","onViewCreated","push","onViewDestroyed","index","indexOf","templateContentBlock","templateElseBlock","updateRootViews","timeout","lastUpdateFailed","modifiedTemplates","Set","templateViewPrefix","clearTimeout","add","setTimeout","__pendingReplacement","delete","console","error","views","pop","parentView","log","isRendered","Package","tracker","Tracker","flush","parent","parentElement","_domrange","next","lastNode","nextSibling","nextComment","document","createComment","insertBefore","detach","destroy","newView","render","slice","members","findIndex","member","removeChild"],"mappings":"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","file":"/packages/blaze-hot.js","sourcesContent":["import { Blaze } from 'meteor/blaze';\nimport { Template as Templates} from 'meteor/templating-runtime';\nimport { UpdateAll } from './update-templates.js';\n\nlet importedTemplating = new WeakMap();\nlet currentModule = {id: null};\nconst SourceModule = Symbol();\n\nfunction patchTemplate(Template) {\n  const oldRegisterHelper = Template.registerHelper;\n  Template.registerHelper = function (name, func) {\n    func[SourceModule] = currentModule.id;\n    oldRegisterHelper(name, func);\n  }\n\n  const oldOnCreated = Template.prototype.onCreated;\n  Template.prototype.onCreated = function (cb) {\n    if (cb) {\n      cb[SourceModule] = currentModule.id;\n    }\n\n    return oldOnCreated.call(this, cb);\n  }\n\n  const oldOnRendered = Template.prototype.onRendered;\n  Template.prototype.onRendered = function (cb) {\n    if (cb) {\n      cb[SourceModule] = currentModule.id;\n    }\n\n    return oldOnRendered.call(this, cb);\n  }\n\n  const oldOnDestroyed = Template.prototype.onDestroyed;\n  Template.prototype.onDestroyed = function (cb) {\n    if (cb) {\n      cb[SourceModule] = currentModule.id;\n    }\n\n    return oldOnDestroyed.call(this, cb);\n  }\n\n  const oldHelpers = Template.prototype.helpers;\n  Template.prototype.helpers = function (dict) {\n    if (typeof dict === 'object') {\n      for (var k in dict) {\n        if (dict[k]) {\n          dict[k][SourceModule] = currentModule.id;\n        }\n      }\n    }\n\n    return oldHelpers.call(this, dict);\n  }\n\n  const oldEvents = Template.prototype.events;\n  Template.prototype.events = function (eventMap) {\n    const result = oldEvents.call(this, eventMap);\n    this.__eventMaps[this.__eventMaps.length - 1][SourceModule] = currentModule.id;\n    return result;\n  }\n}\n\nfunction cleanTemplate(template, moduleId) {\n  let usedModule = false\n  if (!template || !Blaze.isTemplate(template)) {\n    return usedModule;\n  }\n\n  function cleanArray(array) {\n    for (let i = array.length - 1; i >= 0; i--) {\n      let item = array[i];\n      if (item && item[SourceModule] === moduleId) {\n        usedModule = true\n        array.splice(i, 1);\n      }\n    }\n  }\n\n  cleanArray(template._callbacks.created);\n  cleanArray(template._callbacks.rendered);\n  cleanArray(template._callbacks.destroyed);\n  cleanArray(template.__eventMaps);\n\n  Object.keys(template.__helpers).forEach(key => {\n    if (template.__helpers[key] && template.__helpers[key][SourceModule] === moduleId) {\n      usedModule = true\n      delete template.__helpers[key];\n    }\n  });\n\n  return usedModule\n}\n\nfunction shouldAccept(module) {\n  if (!importedTemplating.get(module)) {\n    return false;\n  }\n  if (!module.exports) {\n    return true;\n  }\n\n  return Object.keys(module.exports).filter(key => key !== '__esModule').length === 0;\n}\n\nif (module.hot) {\n  patchTemplate(Blaze.Template);\n  module.hot.onRequire({\n    before(module) {\n      if (module.id === '/node_modules/meteor/blaze.js' || module.id === '/node_modules/meteor/templating.js') {\n        importedTemplating.set(currentModule, true);\n      }\n\n      let previousModule = currentModule;\n      currentModule = module;\n      return previousModule;\n    },\n    after(module, previousModule) {\n      if (shouldAccept(module)) {\n        module.hot.accept();\n        module.hot.dispose(() => {\n          Object.keys(Templates).forEach(templateName => {\n            let template = Templates[templateName]\n            let usedByModule = cleanTemplate(template, module.id);\n            if (usedByModule) {\n              Template._applyHmrChanges(templateName);\n            }\n          });\n\n          Object.values(Blaze._globalHelpers).forEach(helper => {\n            if (helper && helper[SourceModule] === module.id) {\n              Template._applyHmrChanges(UpdateAll);\n            }\n          });\n        });\n      }\n      currentModule = previousModule\n    }\n  });\n}\n","export const UpdateAll = Symbol('update all templates')\n\nlet renderedTemplates = {};\nlet overrideTemplateContentBlock = null;\nlet overrideTemplateElseBlock = null;\n\nconst oldConstructView = Template.prototype.constructView;\n\nTemplate.prototype.constructView = function () {\n  let view = oldConstructView.apply(this, arguments);\n  let templateName = this.viewName;\n\n  view.onViewCreated(function () {\n    renderedTemplates[templateName] = renderedTemplates[templateName] || [];\n    renderedTemplates[templateName].push(view);\n  });\n\n  view.onViewDestroyed(function () {\n    const index = renderedTemplates[templateName].indexOf(view);\n    if (index > -1) {\n      renderedTemplates[templateName].splice(index, 1);\n    }\n  });\n\n  if (overrideTemplateContentBlock) {\n    view.templateContentBlock = overrideTemplateContentBlock;\n    overrideTemplateContentBlock = null;\n  }\n\n  if (overrideTemplateElseBlock) {\n    view.templateElseBlock = overrideTemplateElseBlock;\n    overrideTemplateElseBlock = null;\n  }\n\n  return view;\n}\n\nlet updateRootViews = Template._applyHmrChanges;\n\nlet timeout = null;\nlet lastUpdateFailed = false;\nlet modifiedTemplates = new Set();\nlet templateViewPrefix = 'Template.';\n\n// Overrides the default _applyHmrChanges with one that updates the specific\n// views for modified templates instead of updating everything.\nTemplate._applyHmrChanges = function (templateName = UpdateAll) {\n  if (templateName === UpdateAll || lastUpdateFailed) {\n    lastUpdateFailed = false;\n    clearTimeout(timeout);\n    updateRootViews();\n    return;\n  } else {\n    modifiedTemplates.add(templateName);\n  }\n\n  if (timeout) {\n    return;\n  }\n\n  timeout = setTimeout(() => {\n    for (var i = 0; i < Template.__pendingReplacement.length; i++) {\n      delete Template[Template.__pendingReplacement[i]]\n    }\n\n    Template.__pendingReplacement = [];\n\n    timeout = null;\n    modifiedTemplates.forEach(templateName => {\n      modifiedTemplates.delete(templateName);\n      let viewName = templateName;\n\n      if (!(viewName in renderedTemplates)) {\n        viewName = templateViewPrefix + viewName;\n      } else {\n        console.error('[Blaze HMR] Error: view name does not start with Template');\n        return;\n      }\n\n      if (!(viewName in renderedTemplates)) {\n        return;\n      }\n\n      let views = renderedTemplates[viewName];\n      renderedTemplates[viewName] = [];\n      while (views.length > 0) {\n        let view = views.pop();\n\n        // find first parent template that isn't a content block\n        while (!view.template || view.templateContentBlock || view.templateElseBlock) {\n          if (!view.parentView) {\n            console.log('[Blaze HMR] Unable to update template', viewName);\n            return;\n          }\n\n          view = view.parentView;\n        }\n\n        if (!view.isRendered) {\n          continue;\n        }\n\n        // TODO: this can be removed if we don't update a view, and then update\n        // one of its children (we only need to update the parent).\n        Package.tracker.Tracker.flush();\n\n        let parent = view.parentView;\n        let parentElement = view._domrange.parentElement;\n        let next = view._domrange.lastNode().nextSibling;\n        let nextComment = null;\n\n        if (!next) {\n          // percolate:momentum requires a next node to show the new nodes\n          next = nextComment = document.createComment('Blaze HMR Placeholder');\n          parentElement.insertBefore(nextComment, null);\n        }\n\n        if (!parent) {\n          // TODO: we only need to update a single root view\n          return updateRootViews();\n        }\n\n        if (view.templateContentBlock) {\n          overrideTemplateContentBlock = view.templateContentBlock;\n        }\n        if (view.templateElseBlock) {\n          overrideTemplateElseBlock = view.templateElseBlock;\n        }\n\n        // Since there is a parent range, Blaze will not automatically\n        // detach the dom range.\n        view._domrange.detach();\n        view._domrange.destroy();\n        let newView;\n\n        try {\n          newView = Blaze.render(\n            Template[view.template.viewName.slice('Template.'.length)],\n            parentElement,\n            next,\n            parent\n          );\n        } catch (error) {\n          console.log('[Blaze HMR] Error re-rending template:');\n          console.error(error);\n          lastUpdateFailed = true;\n        }\n\n        let index = parent._domrange.members.findIndex(member => {\n          return member && member.view === view;\n        });\n        if (newView) {\n          parent._domrange.members.splice(index, 1, newView._domrange);\n        } else {\n          parent._domrange.members.splice(index, 1);\n        }\n\n        if (nextComment) {\n          parentElement.removeChild(nextComment);\n        }\n      }\n    });\n  });\n}\n"]}