[{"type":"js","data":"//////////////////////////////////////////////////////////////////////////\n//                                                                      //\n// This is a generated file. You can view the original                  //\n// source in your browser if your browser supports source maps.         //\n// Source maps are supported by all recent versions of Chrome, Safari,  //\n// and Firefox, and by Internet Explorer 11.                            //\n//                                                                      //\n//////////////////////////////////////////////////////////////////////////\n\n\n(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\nvar Accounts = Package['accounts-base'].Accounts;\nvar Mongo = Package.mongo.Mongo;\nvar Collection2 = Package['aldeed:collection2'].Collection2;\nvar CollectionHooks = Package['matb33:collection-hooks'].CollectionHooks;\nvar meteorInstall = Package.modules.meteorInstall;\nvar meteorBabelHelpers = Package.modules.meteorBabelHelpers;\nvar Promise = Package.promise.Promise;\nvar Symbol = Package['ecmascript-runtime-client'].Symbol;\nvar Map = Package['ecmascript-runtime-client'].Map;\nvar Set = Package['ecmascript-runtime-client'].Set;\n\nvar require = meteorInstall({\"node_modules\":{\"meteor\":{\"socialize:user-model\":{\"common\":{\"common.js\":function module(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                          //\n// packages/socialize_user-model/common/common.js                                                           //\n//                                                                                                          //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                            //\nmodule.export({\n  User: function () {\n    return User;\n  },\n  UsersCollection: function () {\n    return UsersCollection;\n  }\n});\nvar Meteor;\nmodule.link(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar check;\nmodule.link(\"meteor/check\", {\n  check: function (v) {\n    check = v;\n  }\n}, 1);\nvar LinkableModel, LinkParent;\nmodule.link(\"meteor/socialize:linkable-model\", {\n  LinkableModel: function (v) {\n    LinkableModel = v;\n  },\n  LinkParent: function (v) {\n    LinkParent = v;\n  }\n}, 2);\nvar construct;\nmodule.link(\"./user-model.js\", {\n  \"default\": function (v) {\n    construct = v;\n  }\n}, 3);\n\nvar _construct = construct({\n  Meteor: Meteor,\n  Package: Package,\n  check: check,\n  LinkableModel: LinkableModel,\n  LinkParent: LinkParent\n}),\n    User = _construct.User,\n    UsersCollection = _construct.UsersCollection;\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n},\"user-model.js\":function module(require,exports,module){\n\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                          //\n// packages/socialize_user-model/common/user-model.js                                                       //\n//                                                                                                          //\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                            //\nvar _inheritsLoose;\n\nmodule.link(\"@babel/runtime/helpers/inheritsLoose\", {\n  default: function (v) {\n    _inheritsLoose = v;\n  }\n}, 0);\nvar SimpleSchema;\nmodule.link(\"simpl-schema\", {\n  \"default\": function (v) {\n    SimpleSchema = v;\n  }\n}, 0);\nmodule.exportDefault(function (_ref) {\n  var Meteor = _ref.Meteor,\n      Package = _ref.Package,\n      check = _ref.check,\n      LinkableModel = _ref.LinkableModel,\n      LinkParent = _ref.LinkParent;\n\n  /**\n  * Represents a User\n  * @class User\n  * @param {Object} document An object representing a user ususally a Mongo document\n  */\n  var User = /*#__PURE__*/function (_LinkParent) {\n    _inheritsLoose(User, _LinkParent);\n\n    function User() {\n      return _LinkParent.apply(this, arguments) || this;\n    }\n\n    //eslint-disable-line\n    User.addFieldsToPublish = function () {\n      function addFieldsToPublish(fieldsObj) {\n        Object.assign(this.fieldsToPublish, fieldsObj);\n      }\n\n      return addFieldsToPublish;\n    }()\n    /**\n    * The personal name of the user account, You if the the user represents the\n    * currently logged in user, or this.username otherwise\n    * @returns {String} A name representation of the user account\n    */\n    ;\n\n    var _proto = User.prototype;\n\n    _proto.displayName = function () {\n      function displayName() {\n        return this.isSelf() ? 'You' : this.username;\n      }\n\n      return displayName;\n    }()\n    /**\n    * Check if the this user is the current logged in user or the specified user\n    * @param   {Object}  user The user to check against\n    * @returns {Boolean} Whether or not this user is the same as the specified user\n    */\n    ;\n\n    _proto.isSelf = function () {\n      function isSelf(user) {\n        var userId = user && user._id || Meteor.userId();\n        return this._id === userId;\n      }\n\n      return isSelf;\n    }();\n\n    return User;\n  }(LinkParent);\n\n  User.fieldsToPublish = {\n    username: 1\n  };\n  User.attachCollection(Meteor.users);\n  var UsersSchema = new SimpleSchema({\n    username: {\n      type: String,\n      // For accounts-password, either emails or username is required, but not both. It is OK to make this\n      // optional here because the accounts-password package does its own validation.\n      // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n      optional: true\n    },\n    emails: {\n      type: Array,\n      // For accounts-password, either emails or username is required, but not both. It is OK to make this\n      // optional here because the accounts-password package does its own validation.\n      // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n      optional: true\n    },\n    'emails.$': {\n      type: Object\n    },\n    'emails.$.address': {\n      type: String,\n      regEx: SimpleSchema.RegEx.Email\n    },\n    'emails.$.verified': {\n      type: Boolean\n    },\n    'emails.$.default': {\n      type: Boolean,\n      optional: true\n    },\n    createdAt: {\n      type: Date\n    },\n    // Make sure this services field is in your schema if you're using any of the accounts packages\n    services: {\n      type: Object,\n      optional: true,\n      blackbox: true\n    },\n    heartbeat: {\n      type: Date,\n      optional: true\n    }\n  });\n  User.attachSchema(UsersSchema);\n  LinkableModel.registerParentModel(User);\n\n  if (Package['accounts-password']) {\n    Meteor.methods && Meteor.methods({\n      /**\n      * Sets the default email for the currently logged in users\n      * @param {String} emailAddress The email address to set as the current\n      */\n      setDefaultEmail: function (emailAddress) {\n        check(emailAddress, String);\n\n        if (this.userId) {\n          var user = Meteor.users.findOne({\n            _id: this.userId,\n            'emails.address': emailAddress\n          });\n\n          if (user) {\n            Meteor.users.update({\n              _id: this.userId,\n              'emails.default': true\n            }, {\n              $set: {\n                'emails.$.default': false\n              }\n            });\n            Meteor.users.update({\n              _id: this.userId,\n              'emails.address': emailAddress\n            }, {\n              $set: {\n                'emails.$.default': true\n              }\n            });\n          }\n        } else {\n          throw new Meteor.Error('NotAuthorized', 'You must be logged in to perform this operation.');\n        }\n      }\n    });\n    User.methods({\n      /**\n      * Set the default email address for the user\n      * @param {[type]} emailAddress [description]\n      */\n      setDefaultEmail: function (emailAddress) {\n        if (Meteor.user().isSelf()) {\n          Meteor.call('setDefaultEmail', emailAddress);\n        }\n      },\n\n      /**\n      * Get the default email address for the user\n      * @returns {String} The users default email address\n      */\n      defaultEmail: function () {\n        var obj = this.emails.find(function (rec) {\n          return rec.default === true;\n        });\n        return obj && obj.address || this.emails[0].address;\n      }\n    });\n  }\n\n  return {\n    User: User,\n    UsersCollection: Meteor.users\n  };\n});\n//////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}}}}}},{\n  \"extensions\": [\n    \".js\",\n    \".json\"\n  ]\n});\n\nvar exports = require(\"/node_modules/meteor/socialize:user-model/common/common.js\");\n\n/* Exports */\nPackage._define(\"socialize:user-model\", exports);\n\n})();\n","servePath":"/packages/socialize_user-model.js","sourceMap":{"version":3,"sources":["packages/socialize:user-model/common/common.js","packages/socialize:user-model/common/user-model.js"],"names":["module","export","User","UsersCollection","Meteor","link","v","check","LinkableModel","LinkParent","construct","Package","_inheritsLoose","default","SimpleSchema","exportDefault","addFieldsToPublish","fieldsObj","Object","assign","fieldsToPublish","displayName","isSelf","username","user","userId","_id","attachCollection","users","UsersSchema","type","String","optional","emails","Array","regEx","RegEx","Email","Boolean","createdAt","Date","services","blackbox","heartbeat","attachSchema","registerParentModel","methods","setDefaultEmail","emailAddress","findOne","update","$set","Error","call","defaultEmail","obj","find","rec","address"],"mappings":"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","file":"/packages/socialize_user-model.js","sourcesContent":["/* global Package */\n/* eslint-disable import/no-unresolved */\nimport { Meteor } from 'meteor/meteor';\nimport { check } from 'meteor/check';\nimport { LinkableModel, LinkParent } from 'meteor/socialize:linkable-model';\n/* eslint-enable import/no-unresolved */\n\nimport construct from './user-model.js';\n\nconst { User, UsersCollection } = construct({ Meteor, Package, check, LinkableModel, LinkParent });\n\nexport { User, UsersCollection };\n","/* eslint-disable import/no-unresolved */\nimport SimpleSchema from 'simpl-schema';\n/* eslint-enable import/no-unresolved */\n\n\nexport default ({ Meteor, Package, check, LinkableModel, LinkParent }) => {\n    /**\n    * Represents a User\n    * @class User\n    * @param {Object} document An object representing a user ususally a Mongo document\n    */\n    class User extends LinkParent { //eslint-disable-line\n        static fieldsToPublish = { username: 1 };\n\n        static addFieldsToPublish(fieldsObj) {\n            Object.assign(this.fieldsToPublish, fieldsObj);\n        }\n\n        /**\n        * The personal name of the user account, You if the the user represents the\n        * currently logged in user, or this.username otherwise\n        * @returns {String} A name representation of the user account\n        */\n        displayName() {\n            return this.isSelf() ? 'You' : this.username;\n        }\n\n        /**\n        * Check if the this user is the current logged in user or the specified user\n        * @param   {Object}  user The user to check against\n        * @returns {Boolean} Whether or not this user is the same as the specified user\n        */\n        isSelf(user) {\n            const userId = (user && user._id) || Meteor.userId();\n\n            return this._id === userId;\n        }\n    }\n\n    User.attachCollection(Meteor.users);\n\n    const UsersSchema = new SimpleSchema({\n        username: {\n            type: String,\n            // For accounts-password, either emails or username is required, but not both. It is OK to make this\n            // optional here because the accounts-password package does its own validation.\n            // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n            optional: true,\n        },\n        emails: {\n            type: Array,\n            // For accounts-password, either emails or username is required, but not both. It is OK to make this\n            // optional here because the accounts-password package does its own validation.\n            // Third-party login packages may not require either. Adjust this schema as necessary for your usage.\n            optional: true,\n        },\n        'emails.$': {\n            type: Object,\n        },\n        'emails.$.address': {\n            type: String,\n            regEx: SimpleSchema.RegEx.Email,\n        },\n        'emails.$.verified': {\n            type: Boolean,\n        },\n        'emails.$.default': {\n            type: Boolean,\n            optional: true,\n        },\n        createdAt: {\n            type: Date,\n        },\n        // Make sure this services field is in your schema if you're using any of the accounts packages\n        services: {\n            type: Object,\n            optional: true,\n            blackbox: true,\n        },\n        heartbeat: {\n            type: Date,\n            optional: true,\n        },\n    });\n\n    User.attachSchema(UsersSchema);\n\n    LinkableModel.registerParentModel(User);\n\n\n    if (Package['accounts-password']) {\n        Meteor.methods && Meteor.methods({\n            /**\n            * Sets the default email for the currently logged in users\n            * @param {String} emailAddress The email address to set as the current\n            */\n            setDefaultEmail(emailAddress) {\n                check(emailAddress, String);\n                if (this.userId) {\n                    const user = Meteor.users.findOne({ _id: this.userId, 'emails.address': emailAddress });\n                    if (user) {\n                        Meteor.users.update({ _id: this.userId, 'emails.default': true }, { $set: { 'emails.$.default': false } });\n                        Meteor.users.update({ _id: this.userId, 'emails.address': emailAddress }, { $set: { 'emails.$.default': true } });\n                    }\n                } else {\n                    throw new Meteor.Error('NotAuthorized', 'You must be logged in to perform this operation.');\n                }\n            },\n        });\n\n        User.methods({\n            /**\n            * Set the default email address for the user\n            * @param {[type]} emailAddress [description]\n            */\n            setDefaultEmail(emailAddress) {\n                if (Meteor.user().isSelf()) {\n                    Meteor.call('setDefaultEmail', emailAddress);\n                }\n            },\n            /**\n            * Get the default email address for the user\n            * @returns {String} The users default email address\n            */\n            defaultEmail() {\n                const obj = this.emails.find(rec => rec.default === true);\n                return (obj && obj.address) || this.emails[0].address;\n            },\n        });\n    }\n\n    return { User, UsersCollection: Meteor.users };\n};\n"]}}]